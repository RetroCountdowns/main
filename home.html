<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home - RetroCountdowns</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0;
      background: #121212;
      color: white;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #1f1f1f;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      user-select: none;
    }
    main {
      flex: 1;
      padding: 2rem;
      text-align: center;
    }
    button#logoutBtn {
      margin-top: 2rem;
      padding: 0.5rem 1rem;
      background-color: #bb86fc;
      border: none;
      border-radius: 4px;
      color: #121212;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button#logoutBtn:hover {
      background-color: #9a67ea;
    }
    footer {
      background: #1f1f1f;
      padding: 0.5rem 1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      position: relative;
    }

    /* Dropdown styling */
    .lang-dropdown {
      position: relative;
      user-select: none;
      cursor: pointer;
      color: #bbb;
      font-weight: 600;
      border: 1.5px solid #bbb;
      padding: 0.3rem 0.8rem;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
      background-color: transparent;
      transition: background-color 0.3s, color 0.3s;
    }
    .lang-dropdown:hover {
      background-color: #333333;
      color: #bb86fc;
      border-color: #bb86fc;
    }
    .lang-dropdown:after {
      content: "‚ñº";
      font-size: 0.6rem;
      margin-left: 6px;
      user-select: none;
    }

    .lang-options {
      position: absolute;
      bottom: 100%;
      background-color: #1f1f1f;
      border: 1.5px solid #bbb;
      border-radius: 4px;
      width: 100%;
      max-width: 100px;
      display: none;
      flex-direction: column;
      user-select: none;
      z-index: 10;
    }
    .lang-options.show {
      display: flex;
    }
    .lang-options button {
      background: none;
      border: none;
      color: #bbb;
      padding: 0.4rem 0.7rem;
      text-align: left;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
      width: 100%;
    }
    .lang-options button:hover {
      background-color: #bb86fc;
      color: #121212;
    }
<style>
  .coins-display {
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 1rem;
    color: gold;
    user-select: none;
  }
  .quest-list {
    max-width: 350px;
    background: #222;
    border-radius: 8px;
    padding: 1rem;
    color: #eee;
    font-family: Arial, sans-serif;
  }
  .quest {
    margin-bottom: 1.3rem;
    border-bottom: 1px solid #444;
    padding-bottom: 0.8rem;
  }
  .quest-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
    font-size: 1.1rem;
  }
  .coin-reward {
    color: #f7d358;
  }
  .quest-status {
    font-size: 1.4rem;
  }
  .progress-bar-container {
    background: #444;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 0.5rem;
    height: 14px;
  }
  .progress-bar {
    height: 100%;
    background: #4caf50;
    width: 0%;
    transition: width 0.4s ease;
  }
  .progress-text {
    margin-top: 0.2rem;
    font-size: 0.9rem;
    color: #bbb;
    text-align: right;
    user-select: none;
  }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCl7uBGgJnfoaYi4By49EItjJZG6Dx0P_k",
      authDomain: "retrocountdowns.firebaseapp.com",
      projectId: "retrocountdowns",
      storageBucket: "retrocountdowns.firebasestorage.app",
      messagingSenderId: "846455265699",
      appId: "1:846455265699:web:e29f1102043afd79282216"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const texts = {
      pl: {
        welcome: (user) => `Witaj, ${user}!`,
        personalHomepage: "To jest Twoja spersonalizowana strona po zalogowaniu.",
<div class="coins-display">Coins: <span id="coinsCount">10</span> ü™ô</div>

<div class="quest-list" id="questList">

  <!-- Questy zostanƒÖ wygenerowane dynamicznie tutaj -->

</div>

<script>
  // QUESTY - konfiguracja
  const quests = [
    {
      id: 'createAccount',
      titlePL: 'Utw√≥rz konto',
      titleEN: 'Create account',
      reward: 10,
      check: () => {
        // Za≈Ç√≥≈ºmy, ≈ºe konto jest utworzone je≈õli jest zapisany czas rejestracji
        return !!localStorage.getItem('accountCreatedAt');
      },
      progressText: () => '1/1',
    },
    {
      id: 'createCountdown',
      titlePL: 'Utw√≥rz odliczanie',
      titleEN: 'Create countdown',
      reward: 8,
      check: () => {
        // Prosty warunek ‚Äî czy w localStorage jest info, ≈ºe odliczanie stworzone
        return !!localStorage.getItem('countdownCreated');
      },
      progressText: () => '1/1',
    },
    {
      id: 'accountAge',
      titlePL: 'Konto ma min. 12 godzin',
      titleEN: 'Account age ‚â• 12h',
      reward: 0,
      check: () => {
        const createdAt = localStorage.getItem('accountCreatedAt');
        if (!createdAt) return false;
        const createdTime = new Date(createdAt).getTime();
        const now = Date.now();
        const diffH = (now - createdTime) / (1000 * 60 * 60);
        return diffH >= 12;
      },
      progressText: () => {
        const createdAt = localStorage.getItem('accountCreatedAt');
        if (!createdAt) return '0/12h';
        const createdTime = new Date(createdAt).getTime();
        const now = Date.now();
        const diffH = (now - createdTime) / (1000 * 60 * 60);
        const progressH = Math.min(diffH, 12).toFixed(1);
        return `${progressH}/12h`;
      },
      reward: 0
    }
  ];

  // Stan coins
  let coins = parseInt(localStorage.getItem('coins')) || 10;

  // Jƒôzyk - na potrzeby przyk≈Çadu w PL, mo≈ºesz pod≈ÇƒÖczyƒá to pod sw√≥j system jƒôzykowy
  let lang = 'pl';

  const coinsEl = document.getElementById('coinsCount');
  const questListEl = document.getElementById('questList');

  function saveCoins() {
    localStorage.setItem('coins', coins);
  }

  function updateUI() {
    coinsEl.textContent = coins;

    questListEl.innerHTML = '';

    let doneCount = 0;
    quests.forEach(q => {
      const done = q.check();
      if(done) doneCount++;
      // Pasek progressa
      let progressPercent = done ? 100 : 0;
      if(q.id === 'accountAge') {
        const createdAt = localStorage.getItem('accountCreatedAt');
        if (createdAt) {
          const createdTime = new Date(createdAt).getTime();
          const now = Date.now();
          const diffH = (now - createdTime) / (1000 * 60 * 60);
          progressPercent = Math.min(100, (diffH / 12) * 100);
        }
      }

      // Tekst tytu≈Çu wg jƒôzyka
      const title = lang === 'pl' ? q.titlePL : q.titleEN;

      questListEl.insertAdjacentHTML('beforeend', `
        <div class="quest" id="quest-${q.id}">
          <div class="quest-header">
            <div>${title} <span class="coin-reward">+${q.reward} ü™ô</span></div>
            <div class="quest-status">${done ? '‚úÖ' : '‚ùå'}</div>
          </div>
          <div class="progress-bar-container">
            <div class="progress-bar" style="width:${progressPercent}%;"></div>
          </div>
          <div class="progress-text">${q.progressText()}</div>
          ${!done && q.reward > 0 ? `<button onclick="claimReward('${q.id}')" style="margin-top:0.6rem; padding: 0.3rem 0.7rem; border:none; background:#4caf50; color:#fff; border-radius:4px; cursor:pointer;">Odbierz nagrodƒô</button>` : ''}
        </div>
      `);
    });

    // Podsumowanie progressa ca≈Çego
    // (opcjonalne) np. pasek globalny progress
  }

  function claimReward(questId) {
    const q = quests.find(q => q.id === questId);
    if (!q) return alert('Quest nie znaleziony');

    if (q.check()) {
      alert('Ten quest zosta≈Ç ju≈º uko≈Ñczony!');
      return;
    }

    // Specjalna obs≈Çuga quest√≥w, kt√≥re nie mogƒÖ byƒá "odbierane" od razu np. accountAge
    if (questId === 'accountAge') {
      alert('Ten quest jest aktywowany automatycznie po spe≈Çnieniu warunku.');
      return;
    }

    // Oznacz quest jako zrobiony w localStorage (dla prostoty)
    if (questId === 'createAccount') {
      // Tutaj nic nie robimy, bo ten quest automatycznie jest spe≈Çniony po utworzeniu konta
      alert('Utw√≥rz konto, aby zdobyƒá ten quest!');
      return;
    }

    if (questId === 'createCountdown') {
      if (!localStorage.getItem('countdownCreated')) {
        alert('Najpierw stw√≥rz odliczanie!');
        return;
      }
    }

    // Je≈õli spe≈Çnione warunki, dodaj coins i zapisz progress
    coins += q.reward;
    saveCoins();

    // Zaznacz quest jako uko≈Ñczony - na razie zapisz do localStorage
    localStorage.setItem('questDone_' + questId, 'true');

    updateUI();
    alert(`Zdoby≈Çe≈õ ${q.reward} coins!`);
  }

  // Inicjuj
  updateUI();

  // --- symulacje / testowe funkcje ---

  // Przyk≈Çad: ≈ºeby "utworzyƒá konto" - ustawiamy datƒô w localStorage (symulacja)
  if (!localStorage.getItem('accountCreatedAt')) {
    localStorage.setItem('accountCreatedAt', new Date().toISOString());
  }

  // Przyk≈Çad: ≈ºeby "utworzyƒá odliczanie"
  // localStorage.setItem('countdownCreated', 'true');
</script>
        logout: "Wyloguj siƒô",
        langName: "PL"
      },
      en: {
        welcome: (user) => `Welcome, ${user}!`,
        personalHomepage: "This is your personal homepage after login.",
        logout: "Logout",
        langName: "EN"
      }
    };

    let currentLang = 'pl';

    function setLanguage(lang, userName) {
      currentLang = lang;
      document.getElementById('welcome').textContent = texts[lang].welcome(userName);
      document.getElementById('personalHomepage').textContent = texts[lang].personalHomepage;
      document.getElementById('logoutBtn').textContent = texts[lang].logout;
      document.getElementById('langDropdownBtn').textContent = texts[lang].langName + " ‚ñº";

      // Ukryj dropdown po wyborze
      document.querySelector('.lang-options').classList.remove('show');
    }

    window.onload = () => {
      const welcomeEl = document.getElementById('welcome');
      const personalHomepageEl = document.getElementById('personalHomepage');
      const logoutBtn = document.getElementById('logoutBtn');
      const langDropdownBtn = document.getElementById('langDropdownBtn');
      const langOptions = document.querySelector('.lang-options');

      onAuthStateChanged(auth, (user) => {
        if (user) {
          const userName = user.displayName || user.email || 'User';
          setLanguage(currentLang, userName);
        } else {
          window.location.href = 'index.html';
        }
      });

      logoutBtn.addEventListener('click', () => {
        signOut(auth).then(() => {
          window.location.href = 'index.html';
        }).catch((error) => {
          alert('Error during logout: ' + error.message);
        });
      });

      langDropdownBtn.addEventListener('click', () => {
        langOptions.classList.toggle('show');
      });

      langOptions.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', () => {
          const user = auth.currentUser;
          if (!user) return;
          const userName = user.displayName || user.email || 'User';
          setLanguage(btn.dataset.lang, userName);
        });
      });

      // Klikniƒôcie poza dropdown zamyka menu
      document.addEventListener('click', (event) => {
        if (!event.target.closest('.lang-dropdown')) {
          langOptions.classList.remove('show');
        }
      });
    };
  </script>
</head>
<body>
  <header>RetroCountdowns - Home</header>
  <main>
    <h1 id="welcome">Loading...</h1>
    <p id="personalHomepage"></p>
    <button id="logoutBtn">Logout</button>
  </main>
  <footer>
    <div class="lang-dropdown" id="langDropdownBtn">PL ‚ñº</div>
    <div class="lang-options">
      <button data-lang="pl">Polski</button>
      <button data-lang="en">English</button>
    </div>
  </footer>
</body>
</html>
